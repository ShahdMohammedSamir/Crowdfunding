{% extends 'base.html' %}
{% block title %}Create Project - Crowdfunding Platform{% endblock %}
{% block content %}
<div class="row justify-content-center">
  <div class="col-md-10 col-lg-8">
    <div class="auth-container shadow-lg rounded-4 overflow-hidden">
      
      <!-- Header -->
      <div class="auth-header text-white text-center py-4" style="background: linear-gradient(135deg, #4CAF50 0%, #2196F3 100%);">
        <h2 class="mb-1"><i class="fas fa-lightbulb me-2"></i> Start a New Project</h2>
        <p class="mb-0 opacity-75">Bring your idea to life with crowdfunding</p>
      </div>

      <div class="auth-body bg-white p-5">
        <form method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
          {% csrf_token %}

          {% if project_form.non_field_errors %}
            <div class="alert alert-danger">
              {% for error in project_form.non_field_errors %}
                {{ error }}
              {% endfor %}
            </div>
          {% endif %}

          <!-- Display messages -->
          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}

          <!-- Project Title -->
          <div class="mb-3">
            <label for="{{ project_form.title.id_for_label }}" class="form-label fw-semibold text-dark">
              <i class="fas fa-heading me-2" style="color: #4CAF50;"></i> Project Title
            </label>
            {{ project_form.title }}
            {% for error in project_form.title.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <!-- Project Details -->
          <div class="mb-3">
            <label for="{{ project_form.details.id_for_label }}" class="form-label fw-semibold text-dark">
              <i class="fas fa-align-left me-2" style="color: #4CAF50;"></i> Project Details
            </label>
            {{ project_form.details }}
            {% for error in project_form.details.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <!-- Tags -->
          <div class="mb-3">
            <label for="{{ project_form.tags.id_for_label }}" class="form-label fw-semibold text-dark">
              <i class="fas fa-tags me-2" style="color: #4CAF50;"></i> Tags
            </label>
            {{ project_form.tags }}
            <div class="form-text">{{ project_form.tags.help_text }}</div>
            {% for error in project_form.tags.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <!-- Category -->
          <div class="mb-3">
            <label for="{{ project_form.category.id_for_label }}" class="form-label fw-semibold text-dark">
              <i class="fas fa-tag me-2" style="color: #4CAF50;"></i> Category
            </label>
            {{ project_form.category }}
            {% for error in project_form.category.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <!-- Funding Target -->
          <div class="mb-3">
            <label for="{{ project_form.total_target.id_for_label }}" class="form-label fw-semibold text-dark">
              <i class="fas fa-bullseye me-2" style="color: #4CAF50;"></i> Funding Target
            </label>
            {{ project_form.total_target }}
            {% for error in project_form.total_target.errors %}
              <div class="invalid-feedback d-block">{{ error }}</div>
            {% endfor %}
          </div>

          <!-- Dates -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="{{ project_form.start_time.id_for_label }}" class="form-label fw-semibold text-dark">
                <i class="fas fa-play-circle me-2" style="color: #4CAF50;"></i> Start Date
              </label>
              {{ project_form.start_time }}
              {% for error in project_form.start_time.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>
            <div class="col-md-6 mb-3">
              <label for="{{ project_form.end_time.id_for_label }}" class="form-label fw-semibold text-dark">
                <i class="fas fa-stop-circle me-2" style="color: #4CAF50;"></i> End Date
              </label>
              {{ project_form.end_time }}
              {% for error in project_form.end_time.errors %}
                <div class="invalid-feedback d-block">{{ error }}</div>
              {% endfor %}
            </div>
          </div>

          <!-- Project Images -->
          <div class="mb-4">
            <label class="form-label fw-semibold text-dark">
              <i class="fas fa-images me-2" style="color: #4CAF50;"></i> Project Images
            </label>
            <div class="text-center">
              <label for="id_image" class="file-label btn btn-outline-primary px-4" style="border-color: #4CAF50; color: #4CAF50;">
                <i class="fas fa-images me-2"></i> Upload Project Photos
              </label>
              <input type="file" name="image" id="id_image" class="d-none" accept="image/*" multiple onchange="previewFiles(event)">
              
              <div class="mt-3 d-flex flex-wrap justify-content-center gap-3" id="previewContainer"></div>
              <div id="fileNames" class="text-muted mt-2 small"></div>
            </div>
          </div>

          <!-- Submit Button -->
          <button type="submit" class="btn btn-primary btn-lg w-100 py-3 fw-bold" style="background: linear-gradient(135deg, #4CAF50 0%, #2196F3 100%); border: none;">
            <i class="fas fa-plus-circle me-2"></i> Create Project
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<style>
  .auth-container {
    border: 1px solid #e9ecef;
    margin: 2rem 0;
  }

  .auth-header {
    border-radius: 0.5rem 0.5rem 0 0;
  }

  .form-control, textarea, select {
    border: 2px solid #dee2e6;
    padding: 12px 16px;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .form-control:focus, textarea:focus, select:focus {
    border-color: #4CAF50;
    box-shadow: 0 0 0 0.2rem rgba(76, 175, 80, 0.25);
  }

  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(76, 175, 80, 0.3);
  }

  .file-label {
    border: 2px dashed #4CAF50;
    padding: 12px 24px;
    border-radius: 8px;
    transition: all 0.3s ease;
    cursor: pointer;
    display: inline-block;
  }

  .file-label:hover {
    background-color: rgba(76, 175, 80, 0.1);
    transform: translateY(-1px);
  }

  #previewContainer img {
    width: 150px;
    height: 150px;
    object-fit: cover;
    border-radius: 8px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    margin: 5px;
  }
</style>

<script>
  // Preview multiple files
  function previewFiles(event) {
    const previewContainer = document.getElementById('previewContainer');
    const fileNames = document.getElementById('fileNames');
    const files = event.target.files;

    previewContainer.innerHTML = '';
    fileNames.textContent = '';

    if (files.length > 0) {
      Array.from(files).forEach(file => {
        const img = document.createElement('img');
        img.src = URL.createObjectURL(file);
        img.classList.add('img-thumbnail');
        previewContainer.appendChild(img);
      });
      fileNames.textContent = files.length + " file(s) selected";
    }
  }

  // Add Bootstrap classes to form fields
  document.addEventListener('DOMContentLoaded', function() {
    // Add form-control class to all inputs, selects, and textareas
    const formElements = document.querySelectorAll('input, select, textarea');
    formElements.forEach(element => {
      if (!element.classList.contains('btn') && !element.classList.contains('d-none')) {
        element.classList.add('form-control');
      }
    });
    
    // Form validation
    const form = document.querySelector('form');
    
    form.addEventListener('submit', function(event) {
      if (!form.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
      }
      
      form.classList.add('was-validated');
    }, false);
  });
</script>
{% endblock %}